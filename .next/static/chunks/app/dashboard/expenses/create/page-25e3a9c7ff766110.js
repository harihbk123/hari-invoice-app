(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7004],{74189:function(e,s,a){Promise.resolve().then(a.bind(a,28121))},28121:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return o}});var t=a(57437),n=a(99376),r=a(27648),i=a(32660),l=a(12381),d=a(72574),c=a(1071);function o(){let e=(0,n.useRouter)(),s=(0,c.cO)(),a=async a=>{await s.mutateAsync(a),e.push("/dashboard/expenses")};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",asChild:!0,children:(0,t.jsxs)(r.default,{href:"/dashboard/expenses",children:[(0,t.jsx)(i.Z,{className:"mr-2 h-4 w-4"}),"Back to Expenses"]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Create Expense"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Add a new business expense"})]})]}),(0,t.jsx)("div",{className:"max-w-2xl",children:(0,t.jsx)(d.V,{onSubmit:a,onCancel:()=>{e.push("/dashboard/expenses")},isLoading:s.isPending})})]})}},72574:function(e,s,a){"use strict";a.d(s,{V:function(){return u}});var t=a(57437),n=a(2265),r=a(79820),i=a(12381),l=a(40279),d=a(50935),c=a(23340),o=a(5526);function u(e){let{expense:s,onSubmit:a,onCancel:u,isLoading:h}=e,{toast:m}=(0,c.pm)(),[x,p]=(0,n.useState)([]),[b,f]=(0,n.useState)(!0),[j,g]=(0,n.useState)({description:(null==s?void 0:s.description)||"",amount:(null==s?void 0:s.amount)||0,category:(null==s?void 0:s.category)||"",date:(null==s?void 0:s.date)||new Date().toISOString().split("T")[0],payment_method:(null==s?void 0:s.payment_method)||"Cash",is_reimbursable:(null==s?void 0:s.is_reimbursable)||!1}),[v,y]=(0,n.useState)({});(0,n.useEffect)(()=>{C()},[]);let C=async()=>{try{let{data:e,error:s}=await o.OQ.from("expense_categories").select("id, name").order("name");if(s)throw s;if(e&&0!==e.length)p(e);else{let{data:e,error:s}=await o.OQ.from("expense_categories").insert([{name:"Office Supplies"},{name:"Travel"},{name:"Meals"},{name:"Software"},{name:"Marketing"},{name:"Utilities"},{name:"Other"}]).select();if(s)throw s;p(e||[])}}catch(e){console.error("Error loading categories:",e),p([{id:"1",name:"Office Supplies"},{id:"2",name:"Travel"},{id:"3",name:"Meals"},{id:"4",name:"Software"},{id:"5",name:"Marketing"},{id:"6",name:"Utilities"},{id:"7",name:"Other"}])}finally{f(!1)}},w=()=>{let e={};return j.description.trim()||(e.description="Description is required"),(!j.amount||j.amount<=0)&&(e.amount="Amount must be greater than 0"),j.category||(e.category="Category is required"),j.date||(e.date="Date is required"),y(e),0===Object.keys(e).length},_=e=>s=>{let a=s.target.value;"amount"===e?a=parseFloat(s.target.value)||0:"is_reimbursable"===e&&(a=s.target.checked),g(s=>({...s,[e]:a})),v[e]&&y(s=>{let a={...s};return delete a[e],a})},N=async e=>{if(e.preventDefault(),w())try{await a(j)}catch(e){m({title:"Error",description:"Failed to save expense. Please try again.",variant:"destructive"})}};return b?(0,t.jsx)("div",{className:"p-8 text-center",children:"Loading categories..."}):(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsx)(r.ll,{children:s?"Edit Expense":"Create New Expense"})}),(0,t.jsx)(r.aY,{children:(0,t.jsxs)("form",{onSubmit:N,className:"space-y-6",children:[(0,t.jsxs)(d.xJ,{children:[(0,t.jsx)(d.lX,{children:"Description *"}),(0,t.jsx)(l.I,{value:j.description,onChange:_("description"),placeholder:"What was this expense for?",disabled:h}),(0,t.jsx)(d.zG,{children:v.description})]}),(0,t.jsxs)(d.xJ,{children:[(0,t.jsx)(d.lX,{children:"Amount *"}),(0,t.jsx)(l.I,{type:"number",step:"0.01",value:j.amount,onChange:_("amount"),placeholder:"0.00",disabled:h}),(0,t.jsx)(d.zG,{children:v.amount})]}),(0,t.jsxs)(d.xJ,{children:[(0,t.jsx)(d.lX,{children:"Category *"}),(0,t.jsxs)("select",{value:j.category,onChange:_("category"),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:h,children:[(0,t.jsx)("option",{value:"",children:"Select a category"}),x.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]}),(0,t.jsx)(d.zG,{children:v.category})]}),(0,t.jsxs)(d.xJ,{children:[(0,t.jsx)(d.lX,{children:"Date *"}),(0,t.jsx)(l.I,{type:"date",value:j.date,onChange:_("date"),disabled:h}),(0,t.jsx)(d.zG,{children:v.date})]}),(0,t.jsxs)(d.xJ,{children:[(0,t.jsx)(d.lX,{children:"Payment Method"}),(0,t.jsxs)("select",{value:j.payment_method,onChange:_("payment_method"),className:"w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:h,children:[(0,t.jsx)("option",{value:"Cash",children:"Cash"}),(0,t.jsx)("option",{value:"Credit Card",children:"Credit Card"}),(0,t.jsx)("option",{value:"Debit Card",children:"Debit Card"}),(0,t.jsx)("option",{value:"Bank Transfer",children:"Bank Transfer"}),(0,t.jsx)("option",{value:"Check",children:"Check"}),(0,t.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,t.jsx)(d.xJ,{children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"is_reimbursable",checked:j.is_reimbursable,onChange:_("is_reimbursable"),disabled:h,className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),(0,t.jsx)(d.lX,{htmlFor:"is_reimbursable",className:"text-sm font-medium",children:"This is a reimbursable expense"})]})}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[u&&(0,t.jsx)(i.Button,{type:"button",variant:"outline",onClick:u,disabled:h,children:"Cancel"}),(0,t.jsx)(i.Button,{type:"submit",disabled:h,children:h?s?"Updating...":"Creating...":s?"Update Expense":"Create Expense"})]})]})})]})}}},function(e){e.O(0,[1524,2972,9763,1906,880,5891,1071,2971,2117,1744],function(){return e(e.s=74189)}),_N_E=e.O()}]);