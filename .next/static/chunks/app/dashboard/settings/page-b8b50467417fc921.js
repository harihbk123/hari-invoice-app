(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3455],{95543:function(e,n,a){Promise.resolve().then(a.bind(a,6856))},6856:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return h}});var t=a(57437),s=a(2265),r=a(79820),i=a(12381),l=a(40279),c=a(50935),o=a(17168),d=a(23340),u=a(4341),m=a(98728),f=a(92369),p=a(88226);function h(){let{toast:e}=(0,d.pm)(),{settings:n,isLoading:a}=(0,u.r)(),h=(0,u.Q)(),[x,g]=(0,s.useState)({company_name:"",company_email:"",company_phone:"",company_address:"",default_currency:"USD",tax_rate:0,invoice_terms:"",profile_name:"",profile_email:"",profile_phone:"",profile_address:"",profile_gstin:"",bank_account_name:"",bank_name:"",bank_account:"",bank_branch:"",bank_ifsc:"",bank_swift:"",account_type:"Current Account"}),[y,_]=(0,s.useState)({});(0,s.useEffect)(()=>{n&&g({company_name:n.company_name||"",company_email:n.company_email||"",company_phone:n.company_phone||"",company_address:n.company_address||"",default_currency:n.default_currency||"USD",tax_rate:n.tax_rate||0,invoice_terms:n.invoice_terms||"",profile_name:n.profile_name||"",profile_email:n.profile_email||"",profile_phone:n.profile_phone||"",profile_address:n.profile_address||"",profile_gstin:n.profile_gstin||"",bank_account_name:n.bank_account_name||"",bank_name:n.bank_name||"",bank_account:n.bank_account||"",bank_branch:n.bank_branch||"",bank_ifsc:n.bank_ifsc||"",bank_swift:n.bank_swift||"",account_type:n.account_type||"Current Account"})},[n]);let v=e=>n=>{let a="tax_rate"===e?parseFloat(n.target.value)||0:n.target.value;g(n=>({...n,[e]:a})),y[e]&&_(n=>{let a={...n};return delete a[e],a})},j=()=>{let e={};return x.company_name.trim()||(e.company_name="Company name is required"),x.company_email.trim()?/\S+@\S+\.\S+/.test(x.company_email)||(e.company_email="Invalid email address"):e.company_email="Company email is required",(x.tax_rate<0||x.tax_rate>100)&&(e.tax_rate="Tax rate must be between 0 and 100"),_(e),0===Object.keys(e).length},b=async e=>{if(e.preventDefault(),j())try{await h.mutateAsync(x)}catch(e){console.error("Error updating settings:",e)}};return a?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsx)("div",{className:"text-muted-foreground",children:"Loading settings..."})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Settings"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage your account and application preferences"})]}),(0,t.jsxs)(o.mQ,{defaultValue:"company",className:"space-y-6",children:[(0,t.jsxs)(o.dr,{children:[(0,t.jsxs)(o.SP,{value:"company",children:[(0,t.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Company"]}),(0,t.jsxs)(o.SP,{value:"profile",children:[(0,t.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Profile"]}),(0,t.jsxs)(o.SP,{value:"banking",children:[(0,t.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Banking"]})]}),(0,t.jsxs)("form",{onSubmit:b,children:[(0,t.jsx)(o.nU,{value:"company",className:"space-y-6",children:(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsx)(r.ll,{children:"Company Information"})}),(0,t.jsxs)(r.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Company Name *"}),(0,t.jsx)(l.I,{value:x.company_name,onChange:v("company_name"),placeholder:"Your Company Name"}),(0,t.jsx)(c.zG,{children:y.company_name})]}),(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Company Email *"}),(0,t.jsx)(l.I,{type:"email",value:x.company_email,onChange:v("company_email"),placeholder:"company@example.com"}),(0,t.jsx)(c.zG,{children:y.company_email})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Phone Number"}),(0,t.jsx)(l.I,{value:x.company_phone,onChange:v("company_phone"),placeholder:"+1 (555) 123-4567"})]}),(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Default Currency"}),(0,t.jsxs)("select",{value:x.default_currency,onChange:e=>g(n=>({...n,default_currency:e.target.value})),className:"w-full p-2 border rounded-md",children:[(0,t.jsx)("option",{value:"USD",children:"USD - US Dollar"}),(0,t.jsx)("option",{value:"EUR",children:"EUR - Euro"}),(0,t.jsx)("option",{value:"GBP",children:"GBP - British Pound"}),(0,t.jsx)("option",{value:"INR",children:"INR - Indian Rupee"})]})]})]}),(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Company Address"}),(0,t.jsx)("textarea",{value:x.company_address,onChange:v("company_address"),placeholder:"Full company address",className:"w-full p-2 border rounded-md min-h-[80px]"})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Tax Rate (%)"}),(0,t.jsx)(l.I,{type:"number",step:"0.01",min:"0",max:"100",value:x.tax_rate,onChange:v("tax_rate"),placeholder:"0.00"}),(0,t.jsx)(c.zG,{children:y.tax_rate})]})}),(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Invoice Terms"}),(0,t.jsx)("textarea",{value:x.invoice_terms,onChange:v("invoice_terms"),placeholder:"Payment terms and conditions",className:"w-full p-2 border rounded-md min-h-[100px]"})]})]})]})}),(0,t.jsx)(o.nU,{value:"profile",className:"space-y-6",children:(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsx)(r.ll,{children:"Personal Profile"})}),(0,t.jsxs)(r.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Full Name"}),(0,t.jsx)(l.I,{value:x.profile_name,onChange:v("profile_name"),placeholder:"Your full name"})]}),(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Email"}),(0,t.jsx)(l.I,{type:"email",value:x.profile_email,onChange:v("profile_email"),placeholder:"your@email.com"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Phone"}),(0,t.jsx)(l.I,{value:x.profile_phone,onChange:v("profile_phone"),placeholder:"+1 (555) 123-4567"})]}),(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"GSTIN"}),(0,t.jsx)(l.I,{value:x.profile_gstin,onChange:v("profile_gstin"),placeholder:"GST Identification Number"})]})]}),(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Address"}),(0,t.jsx)("textarea",{value:x.profile_address,onChange:v("profile_address"),placeholder:"Your full address",className:"w-full p-2 border rounded-md min-h-[80px]"})]})]})]})}),(0,t.jsx)(o.nU,{value:"banking",className:"space-y-6",children:(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsx)(r.ll,{children:"Banking Information"})}),(0,t.jsxs)(r.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Account Name"}),(0,t.jsx)(l.I,{value:x.bank_account_name,onChange:v("bank_account_name"),placeholder:"Account holder name"})]}),(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Bank Name"}),(0,t.jsx)(l.I,{value:x.bank_name,onChange:v("bank_name"),placeholder:"Name of your bank"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Account Number"}),(0,t.jsx)(l.I,{value:x.bank_account,onChange:v("bank_account"),placeholder:"Your account number"})]}),(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Account Type"}),(0,t.jsxs)("select",{value:x.account_type,onChange:e=>g(n=>({...n,account_type:e.target.value})),className:"w-full p-2 border rounded-md",children:[(0,t.jsx)("option",{value:"Current Account",children:"Current Account"}),(0,t.jsx)("option",{value:"Savings Account",children:"Savings Account"}),(0,t.jsx)("option",{value:"Business Account",children:"Business Account"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"Branch Name"}),(0,t.jsx)(l.I,{value:x.bank_branch,onChange:v("bank_branch"),placeholder:"Bank branch name"})]}),(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"IFSC Code"}),(0,t.jsx)(l.I,{value:x.bank_ifsc,onChange:v("bank_ifsc"),placeholder:"IFSC code"})]})]}),(0,t.jsxs)(c.xJ,{children:[(0,t.jsx)(c.lX,{children:"SWIFT Code"}),(0,t.jsx)(l.I,{value:x.bank_swift,onChange:v("bank_swift"),placeholder:"SWIFT/BIC code (for international)"})]})]})]})}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(i.Button,{type:"submit",disabled:h.isPending,className:"min-w-[100px]",children:h.isPending?"Saving...":"Save Settings"})})]})]})]})}},17168:function(e,n,a){"use strict";a.d(n,{SP:function(){return o},dr:function(){return c},mQ:function(){return l},nU:function(){return d}});var t=a(57437),s=a(2265),r=a(49707),i=a(93448);let l=r.fC,c=s.forwardRef((e,n)=>{let{className:a,...s}=e;return(0,t.jsx)(r.aV,{ref:n,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...s})});c.displayName=r.aV.displayName;let o=s.forwardRef((e,n)=>{let{className:a,...s}=e;return(0,t.jsx)(r.xz,{ref:n,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...s})});o.displayName=r.xz.displayName;let d=s.forwardRef((e,n)=>{let{className:a,...s}=e;return(0,t.jsx)(r.VY,{ref:n,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...s})});d.displayName=r.VY.displayName},4341:function(e,n,a){"use strict";a.d(n,{Q:function(){return d},r:function(){return o}});var t=a(48852),s=a(29827),r=a(64250),i=a(96629),l=a(23340),c=a(97160);function o(){let e=(0,c.o)(e=>e.setSettings),n=(0,t.a)({queryKey:["settings"],queryFn:async()=>{let n=await (0,i.Gw)();return n&&e(n),n}});return{settings:n.data,isLoading:n.isLoading,error:n.error,refetch:n.refetch}}function d(){let{toast:e}=(0,l.pm)(),n=(0,s.NL)(),a=(0,c.o)(e=>e.setSettings);return(0,r.D)({mutationFn:i.VP,onSuccess:t=>{t&&a(t),n.invalidateQueries({queryKey:["settings"]}),e({title:"Success",description:"Settings updated successfully"})},onError:n=>{e({title:"Error",description:n.message||"Failed to update settings",variant:"destructive"})}})}},96629:function(e,n,a){"use strict";a.d(n,{E:function(){return g},Eb:function(){return j},Fl:function(){return x},Gw:function(){return _},Nu:function(){return c},Qu:function(){return l},T4:function(){return p},VP:function(){return v},Wu:function(){return m},YD:function(){return h},ZL:function(){return s},d5:function(){return d},eI:function(){return i},rk:function(){return f},s3:function(){return r},sA:function(){return o},vu:function(){return y}});var t=a(5526);async function s(){let{data:e,error:n}=await t.OQ.from("clients").select("*").order("created_at",{ascending:!1});if(n)throw n;return e||[]}async function r(e){let{data:n,error:a}=await t.OQ.from("clients").select("*").eq("id",e).single();if(a)throw a;return n}async function i(e){let{data:n,error:a}=await t.OQ.from("clients").insert([e]).select().single();if(a)throw a;return n}async function l(e,n){let{data:a,error:s}=await t.OQ.from("clients").update(n).eq("id",e).select().single();if(s)throw s;return a}async function c(e){let{error:n}=await t.OQ.from("clients").delete().eq("id",e);if(n)throw n}async function o(){let{data:e,error:n}=await t.OQ.from("invoices").select("\n      *,\n      clients (\n        id,\n        name,\n        email,\n        company\n      )\n    ").order("created_at",{ascending:!1});if(n)throw n;return e||[]}async function d(e){let{data:n,error:a}=await t.OQ.from("invoices").select("\n      *,\n      clients (\n        id,\n        name,\n        email,\n        company\n      )\n    ").eq("id",e).single();if(a)throw a;return n}async function u(e,n){let{data:a,error:s}=await t.OQ.from("invoices").update(n).eq("id",e).select().single();if(s)throw s;return a}async function m(e){let{error:n}=await t.OQ.from("invoices").delete().eq("id",e);if(n)throw n}async function f(e,n){return u(e,{status:n})}async function p(){let{data:e,error:n}=await t.OQ.from("expenses").select("*").order("date",{ascending:!1});if(n)throw n;return e||[]}async function h(e){let{data:n,error:a}=await t.OQ.from("expenses").select("*").eq("id",e).single();if(a)throw a;return n}async function x(e){let{data:n,error:a}=await t.OQ.from("expenses").insert([e]).select().single();if(a)throw a;return n}async function g(e,n){let{data:a,error:s}=await t.OQ.from("expenses").update(n).eq("id",e).select().single();if(s)throw s;return a}async function y(e){let{error:n}=await t.OQ.from("expenses").delete().eq("id",e);if(n)throw n}async function _(){let{data:{user:e}}=await t.OQ.auth.getUser();if(!e)return null;let{data:n,error:a}=await t.OQ.from("settings").select("*").eq("user_id",e.id).single();if(a&&"PGRST116"!==a.code)throw a;return n||null}async function v(e){let{data:{user:n}}=await t.OQ.auth.getUser();if(!n)throw Error("User not authenticated");let{data:a,error:s}=await t.OQ.from("settings").upsert({...e,user_id:n.id}).select().single();if(s)throw s;return a}async function j(){try{let[e,n,a]=await Promise.all([t.OQ.from("invoices").select("\n        *,\n        clients (\n          id,\n          name,\n          email,\n          company\n        )\n      "),t.OQ.from("clients").select("*"),t.OQ.from("expenses").select("*")]),s=e.data||[],r=n.data||[],i=a.data||[],l=s.filter(e=>"Paid"===e.status).reduce((e,n)=>e+n.amount,0),c=i.reduce((e,n)=>e+n.amount,0),o=function(e){let n=new Map;return e.filter(e=>"Paid"===e.status).forEach(e=>{let a=new Date(e.created_at);"".concat(a.getFullYear(),"-").concat((a.getMonth()+1).toString().padStart(2,"0"));let t=a.toLocaleDateString("en-US",{year:"numeric",month:"short"});n.set(t,(n.get(t)||0)+e.amount)}),Array.from(n.entries()).map(e=>{let[n,a]=e;return{month:n,revenue:a}})}(s),d=function(e){let n=new Map;return e.forEach(e=>{let a=e.category||"Uncategorized";n.set(a,(n.get(a)||0)+e.amount)}),Array.from(n.entries()).map(e=>{let[n,a]=e;return{category:n,amount:a}})}(i),u=function(e){let n=new Map;return e.filter(e=>"Paid"===e.status).forEach(e=>{var a;let t=(null===(a=e.clients)||void 0===a?void 0:a.name)||"Unknown Client";n.set(t,(n.get(t)||0)+e.amount)}),Array.from(n.entries()).map(e=>{let[n,a]=e;return{client:n,revenue:a}}).sort((e,n)=>n.revenue-e.revenue).slice(0,10)}(s),m=function(e){let n=new Map;return e.forEach(e=>{let a=e.status||"Unknown";n.set(a,(n.get(a)||0)+1)}),Array.from(n.entries()).map(e=>{let[n,a]=e;return{status:n,count:a}})}(s);return{totalRevenue:l,totalExpenses:c,totalClients:r.length,totalInvoices:s.length,monthlyRevenue:o,expensesByCategory:d,clientRevenue:u,invoiceStatusDistribution:m}}catch(e){throw console.error("Error fetching analytics data:",e),e}}},97160:function(e,n,a){"use strict";a.d(n,{o:function(){return r}});var t=a(59625),s=a(5526);let r=(0,t.Ue)((e,n)=>({user:null,clients:[],invoices:[],expenses:[],expenseCategories:[],settings:null,balanceSummary:null,isLoading:!1,isLoadingClients:!1,isLoadingInvoices:!1,isLoadingExpenses:!1,setUser:n=>e({user:n}),setLoading:n=>e({isLoading:n}),setClients:n=>e({clients:n}),setInvoices:n=>e({invoices:n}),setExpenses:n=>e({expenses:n}),setSettings:n=>e({settings:n}),setBalanceSummary:n=>e({balanceSummary:n}),loadInitialData:async()=>{e({isLoading:!0});try{let[a,t,r,i,l]=await Promise.all([s.TW.getClients(),s.TW.getInvoices(),s.TW.getExpenses(),s.TW.getExpenseCategories(),s.TW.getBalanceSummary()]);a.data&&e({clients:a.data}),t.data&&e({invoices:t.data}),r.data&&e({expenses:r.data}),i.data&&e({expenseCategories:i.data}),l.data&&e({balanceSummary:l.data});let{user:c}=n();if(c){let n=await s.TW.getSettings(c.id);n.data&&e({settings:n.data})}}catch(e){console.error("Error loading initial data:",e)}finally{e({isLoading:!1})}},addClient:n=>e(e=>({clients:[n,...e.clients]})),updateClient:(n,a)=>e(e=>({clients:e.clients.map(e=>e.id===n?{...e,...a}:e)})),removeClient:n=>e(e=>({clients:e.clients.filter(e=>e.id!==n)})),addInvoice:n=>e(e=>({invoices:[n,...e.invoices]})),updateInvoice:(n,a)=>e(e=>({invoices:e.invoices.map(e=>e.id===n?{...e,...a}:e)})),removeInvoice:n=>e(e=>({invoices:e.invoices.filter(e=>e.id!==n)})),addExpense:n=>e(e=>({expenses:[n,...e.expenses]})),updateExpense:(n,a)=>e(e=>({expenses:e.expenses.map(e=>e.id===n?{...e,...a}:e)})),removeExpense:n=>e(e=>({expenses:e.expenses.filter(e=>e.id!==n)})),updateSettings:n=>e(e=>({settings:e.settings?{...e.settings,...n}:null})),updateBalanceSummary:n=>e(e=>({balanceSummary:e.balanceSummary?{...e.balanceSummary,...n}:null})),getTotalEarnings:()=>{let{invoices:e}=n();return e.filter(e=>"Paid"===e.status).reduce((e,n)=>e+n.amount,0)},getTotalExpenses:()=>{let{expenses:e}=n();return e.reduce((e,n)=>e+n.amount,0)},getCurrentBalance:()=>{let{getTotalEarnings:e,getTotalExpenses:a}=n();return e()-a()},getRecentInvoices:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,{invoices:a}=n();return a.slice().sort((e,n)=>new Date(n.created_at).getTime()-new Date(e.created_at).getTime()).slice(0,e)},getRecentExpenses:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,{expenses:a}=n();return a.slice().sort((e,n)=>new Date(n.created_at).getTime()-new Date(e.created_at).getTime()).slice(0,e)},getOverdueInvoices:()=>{let{invoices:e}=n(),a=new Date;return e.filter(e=>"Pending"===e.status&&new Date(e.due_date)<a)},reset:()=>e({user:null,clients:[],invoices:[],expenses:[],expenseCategories:[],settings:null,balanceSummary:null,isLoading:!1,isLoadingClients:!1,isLoadingInvoices:!1,isLoadingExpenses:!1})}))}},function(e){e.O(0,[1524,8828,6052,9707,8476,5891,2971,2117,1744],function(){return e(e.s=95543)}),_N_E=e.O()}]);